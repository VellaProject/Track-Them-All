<html>
	<head>
		<title>Track Them All</title>
		<style>
		body { margin: 0; }
			canvas { width: 100%; height: 100%; background-image:url("http://iwallpapers.free.fr/upload/2013/01/05/20130105165505-dcc9fdf8.jpg");}
		</style>
	</head>
	<body>
		<script src="http://threejs.org/build/three.js"></script>
		<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var object = [];
			var object_img = [];
			var socket = io.connect('http://localhost:8080');
			var index = 0;
			var full_bar = 1;
			
			socket.on('get_info', function(tweet_text, tweet_img_url, tweet_user_name, screen_name){
				object[index] = document.createElement('div');	
				object[index].style.position = 'absolute';
				object[index].style.width = 260;
				object[index].style.backgroundImage= "url('http://www.pixelstalk.net/wp-content/uploads/2016/06/HD-Twitter-Background-620x388.png')";
				object[index].innerHTML = "<B>Nom:</B> <span style='background:#FFFFFF'><B>" + tweet_user_name +"</B></span> ||<br />@" + screen_name + "<br /><br /> " + tweet_text;
				var alea_top = aleatoire(400, 600);
				var alea_left = aleatoire(0, 1500);
				object[index].style.top = alea_top + 'px';
				object[index].style.left = alea_left + 'px';
				object[index].style.borderRadius = "8px";
				object[index].style.borderColor = "black";
				object[index].style.borderStyle = "solid";
				object[index].style.borderWidth = "3px";
				object[index].style.boxShadow = "5px 5px 5px #555";
				object_img[index] = document.createElement("img");
				object_img[index].setAttribute("src", tweet_img_url);
				object_img[index].setAttribute("height", "70");
				object_img[index].setAttribute("width", "70");
				object_img[index].style.position = 'absolute';
				object_img[index].style.top = alea_top - 70 + 'px';
				object_img[index].style.left = alea_left + 92 + 'px';
				object_img[index].style.borderRadius = "8px";
				object_img[index].style.borderColor = "black";
				object_img[index].style.borderStyle = "solid";
				object_img[index].style.borderWidth = "3px";
				object_img[index].style.boxShadow = "5px 5px 5px #555";
				document.body.appendChild(object_img[index]);
				document.body.appendChild(object[index]);
				index++;
			 });
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );
			var renderer = new THREE.WebGLRenderer({ alpha: true });
			
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

			var geometry = new THREE.BoxGeometry( 2, 0.2, 0.4 );
			var material = new THREE.MeshBasicMaterial( { color: 0x0000ff } );
			var material2 = new THREE.MeshBasicMaterial( { color: 0xffffff } );
			var material3 = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
			var cube = new THREE.Mesh( geometry, material );
			var cube2 =  new THREE.Mesh( geometry, material2 );
			var cube3 =  new THREE.Mesh( geometry, material3 );
			
			scene.add( cube );
			scene.add(cube2);
			scene.add(cube3);
			cube.position.y = -2;	
			cube2.position.y = cube.position.y;	
			cube3.position.y = cube.position.y;					
			cube.position.x = -3;		
			cube2.position.x = cube.position.x + 3;
			cube3.position.x = cube2.position.x + 3;;
			camera.position.z = 5;
			
			function aleatoire(min, max) { 
				return (Math.floor((max-min)*Math.random())+min); 
			} 
			var render = function () {
				var longueur = object.length;
				requestAnimationFrame( render );
				for(var i=0; i<longueur; i++)
				{
			
					var posY = object[i].offsetTop;
					var posY2 = object_img[i].offsetTop;
					object_img[i].style.top = posY2 - full_bar  +'px';
					object[i].style.top = posY - full_bar  +'px';
				}
				cube.rotation.y += 0.1;
				cube2.rotation.y += 0.1;
				cube3.rotation.y += 0.1;
				renderer.render(scene, camera);
			};
			render();	
		</script>
	</body>
</html>